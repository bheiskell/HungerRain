package org.xdxa.hungerrain.minecraft;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertTrue;

import java.util.Random;

import org.junit.Test;
import org.xdxa.hungerrain.minecraft.MinecraftSimplexNoiseGenerator;

/**
 * Test the {@link MinecraftSimplexNoiseGenerator}.
 */
public class MinecraftSimplexNoiseGeneratorTest {
    private static final int TEST_RANGE = 16;

    /**
     * Test that the {@link MinecraftSimplexNoiseGenerator} is consistent with the client side results.
     */
    @Test
    public void testExpectedResults() {
        final MinecraftSimplexNoiseGenerator noiseGenerator = new MinecraftSimplexNoiseGenerator(new Random(1234L));
        for (int i = 0; i < 2; i++) { // verify it's idempotent
            for (int x = 0; x < TEST_RANGE; x++) {
                for (int z = 0; z < TEST_RANGE; z++) {
                    final double noiseX = x * 1.0D / 8.0D;
                    final double noiseZ = z * 1.0D / 8.0D;

                    // truncating for simplicity
                    final Float noise = (float)noiseGenerator.noise(noiseX, noiseZ);

                    assertTrue("Noise too large on (" + x + ":" + z + ") " + noise, noise < 1);
                    assertTrue("Noise too small on (" + x + ":" + z + ") " + noise, noise > -1);
                    assertEquals("Noise mismatch on (" + x + ":" + z + ")", noise,
                            Float.valueOf((float)EXPECTED_RESULTS[x * TEST_RANGE + z]));
                }
            }
        }
    }

    private static double[] EXPECTED_RESULTS = {
        0.0, -0.48165146, -0.6133589, -0.25243545, 0.24667867, 0.38262746, 0.119098626, -0.24864005, -0.4950942, -0.55292135, -0.5216341, -0.561202, -0.6150663, -0.50765294, -0.19318171, 0.067811385,
        -0.481653, -0.8470443, -0.85696477, -0.4853047, 0.0015770822, 0.21320707, 0.119581185, -0.11458443, -0.3491143, -0.49838924, -0.5993079, -0.65857685, -0.59071237, -0.31704527, 0.16268747, 0.5211526,
        -0.6306331, -0.86918604, -0.84477293, -0.551786, -0.15127125, 0.12999344, 0.22688589, 0.11206026, -0.114369676, -0.29242665, -0.40778223, -0.45481107, -0.39091298, -0.166034, 0.29344952, 0.73963994,
        -0.35141796, -0.57037747, -0.6853543, -0.5530843, -0.2363481, 0.14842732, 0.41197366, 0.39229044, 0.19192103, 0.048442505, 0.035179842, 0.039213285, 0.033916205, 0.067549795, 0.31450704, 0.6855355,
        0.11964835, -0.15422274, -0.52236897, -0.60446095, -0.3071565, 0.19503987, 0.56223845, 0.5945072, 0.43008667, 0.35620412, 0.45170736, 0.5060511, 0.43912706, 0.32144293, 0.30174473, 0.42782336,
        0.46317747, 0.15807852, -0.38506556, -0.60513943, -0.3166101, 0.20099692, 0.5788916, 0.5858374, 0.38158438, 0.3272588, 0.50193584, 0.61920226, 0.5880513, 0.4988608, 0.36167482, 0.21685529,
        0.61342144, 0.36118665, -0.18857518, -0.46641862, -0.25619993, 0.15892239, 0.404468, 0.23372385, -0.09726162, -0.15018535, 0.10736173, 0.34158343, 0.48317885, 0.55889004, 0.49009496, 0.21379188,
        0.58542526, 0.37420216, -0.123342045, -0.40090352, -0.26212457, 0.02440619, 0.03873611, -0.31913957, -0.6702113, -0.63388497, -0.27899134, 0.07427064, 0.37377536, 0.59101546, 0.59842837, 0.27738643,
        0.34651035, 0.08668152, -0.33240867, -0.54071575, -0.42995942, -0.24004717, -0.34357873, -0.703919, -0.8928153, -0.658013, -0.19546762, 0.19376805, 0.47025195, 0.6381874, 0.60968584, 0.28072315,
        0.045717478, -0.23388183, -0.5405767, -0.65187633, -0.55393493, -0.41727775, -0.50121075, -0.695277, -0.65817136, -0.25623116, 0.2647929, 0.567047, 0.62667954, 0.5839802, 0.47814152, 0.21717134,
        -0.13660538, -0.25491798, -0.4058077, -0.45481104, -0.3921843, -0.31095502, -0.35543546, -0.39615175, -0.19816221, 0.2647929, 0.7191956, 0.8576574, 0.6822364, 0.43375066, 0.26022562, 0.086776584,
        -0.16938873, -5.630893E-4, 0.035179663, 0.039213285, 0.033891283, 0.004311644, -0.07358474, -0.074360795, 0.14986719, 0.54449695, 0.8581353, 0.9030885, 0.65573245, 0.30860537, 0.059858937, -0.10996316,
        -0.15522432, 0.24748805, 0.45122564, 0.5060427, 0.43912706, 0.3139719, 0.17614557, 0.09978174, 0.18450816, 0.39364123, 0.61784786, 0.7344396, 0.61092716, 0.3059741, -0.04223272, -0.32294157,
        -0.20026395, 0.21935618, 0.47542658, 0.5929019, 0.5831811, 0.4988608, 0.3517529, 0.15346481, -0.0036527894, -0.034400314, 0.17008196, 0.49927366, 0.614583, 0.38892502, -0.07138351, -0.48065156,
        -0.31886008, -0.16205359, -0.04544961, 0.13032496, 0.37601486, 0.5473599, 0.49009496, 0.21298444, -0.1697857, -0.40316248, -0.2070824, 0.30859092, 0.6205459, 0.42573854, -0.0781237, -0.52785605,
        -0.3013816, -0.5152474, -0.66597784, -0.52424353, -0.031202747, 0.48442823, 0.59670985, 0.27738643, -0.23247685, -0.57444537, -0.4306952, 0.10785995, 0.48530775, 0.35853362, -0.06631666, -0.4515263,
        0.0, -0.48165146, -0.6133589, -0.25243545, 0.24667867, 0.38262746, 0.119098626, -0.24864005, -0.4950942, -0.55292135, -0.5216341, -0.561202, -0.6150663, -0.50765294, -0.19318171, 0.067811385,
        -0.481653, -0.8470443, -0.85696477, -0.4853047, 0.0015770822, 0.21320707, 0.119581185, -0.11458443, -0.3491143, -0.49838924, -0.5993079, -0.65857685, -0.59071237, -0.31704527, 0.16268747, 0.5211526,
        -0.6306331, -0.86918604, -0.84477293, -0.551786, -0.15127125, 0.12999344, 0.22688589, 0.11206026, -0.114369676, -0.29242665, -0.40778223, -0.45481107, -0.39091298, -0.166034, 0.29344952, 0.73963994,
        -0.35141796, -0.57037747, -0.6853543, -0.5530843, -0.2363481, 0.14842732, 0.41197366, 0.39229044, 0.19192103, 0.048442505, 0.035179842, 0.039213285, 0.033916205, 0.067549795, 0.31450704, 0.6855355,
        0.11964835, -0.15422274, -0.52236897, -0.60446095, -0.3071565, 0.19503987, 0.56223845, 0.5945072, 0.43008667, 0.35620412, 0.45170736, 0.5060511, 0.43912706, 0.32144293, 0.30174473, 0.42782336,
        0.46317747, 0.15807852, -0.38506556, -0.60513943, -0.3166101, 0.20099692, 0.5788916, 0.5858374, 0.38158438, 0.3272588, 0.50193584, 0.61920226, 0.5880513, 0.4988608, 0.36167482, 0.21685529,
        0.61342144, 0.36118665, -0.18857518, -0.46641862, -0.25619993, 0.15892239, 0.404468, 0.23372385, -0.09726162, -0.15018535, 0.10736173, 0.34158343, 0.48317885, 0.55889004, 0.49009496, 0.21379188,
        0.58542526, 0.37420216, -0.123342045, -0.40090352, -0.26212457, 0.02440619, 0.03873611, -0.31913957, -0.6702113, -0.63388497, -0.27899134, 0.07427064, 0.37377536, 0.59101546, 0.59842837, 0.27738643,
        0.34651035, 0.08668152, -0.33240867, -0.54071575, -0.42995942, -0.24004717, -0.34357873, -0.703919, -0.8928153, -0.658013, -0.19546762, 0.19376805, 0.47025195, 0.6381874, 0.60968584, 0.28072315,
        0.045717478, -0.23388183, -0.5405767, -0.65187633, -0.55393493, -0.41727775, -0.50121075, -0.695277, -0.65817136, -0.25623116, 0.2647929, 0.567047, 0.62667954, 0.5839802, 0.47814152, 0.21717134,
        -0.13660538, -0.25491798, -0.4058077, -0.45481104, -0.3921843, -0.31095502, -0.35543546, -0.39615175, -0.19816221, 0.2647929, 0.7191956, 0.8576574, 0.6822364, 0.43375066, 0.26022562, 0.086776584,
        -0.16938873, -5.630893E-4, 0.035179663, 0.039213285, 0.033891283, 0.004311644, -0.07358474, -0.074360795, 0.14986719, 0.54449695, 0.8581353, 0.9030885, 0.65573245, 0.30860537, 0.059858937, -0.10996316,
        -0.15522432, 0.24748805, 0.45122564, 0.5060427, 0.43912706, 0.3139719, 0.17614557, 0.09978174, 0.18450816, 0.39364123, 0.61784786, 0.7344396, 0.61092716, 0.3059741, -0.04223272, -0.32294157,
        -0.20026395, 0.21935618, 0.47542658, 0.5929019, 0.5831811, 0.4988608, 0.3517529, 0.15346481, -0.0036527894, -0.034400314, 0.17008196, 0.49927366, 0.614583, 0.38892502, -0.07138351, -0.48065156,
        -0.31886008, -0.16205359, -0.04544961, 0.13032496, 0.37601486, 0.5473599, 0.49009496, 0.21298444, -0.1697857, -0.40316248, -0.2070824, 0.30859092, 0.6205459, 0.42573854, -0.0781237, -0.52785605,
        -0.3013816, -0.5152474, -0.66597784, -0.52424353, -0.031202747, 0.48442823, 0.59670985, 0.27738643, -0.23247685, -0.57444537, -0.4306952, 0.10785995, 0.48530775, 0.35853362, -0.06631666, -0.4515263
    };
}
